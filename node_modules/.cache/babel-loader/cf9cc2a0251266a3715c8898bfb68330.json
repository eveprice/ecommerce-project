{"ast":null,"code":"import _regeneratorRuntime from\"/home/twilightmoon/Documents/Projects/ecommerce-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/twilightmoon/Documents/Projects/ecommerce-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/twilightmoon/Documents/Projects/ecommerce-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import Rating from\"@material-ui/lab/Rating\";import{Container,CartContainer,Info,Row,StockInfo,FinalInfo,BuyNowBtn}from\"./styles\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function CartCard(props){var _useState=useState(true),_useState2=_slicedToArray(_useState,2),valid=_useState2[0],setValid=_useState2[1];function undoRemove(){setValid(!valid);fetch(\"\".concat(process.env.REACT_APP_SERVER_URL,\"/cart/addToCart\"),{method:\"post\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \".concat(localStorage.getItem(\"access_token\"))},body:JSON.stringify({productId:props.id,quantity:props.quantity})}).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(res){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.t0=res.status;_context.next=_context.t0===200?3:5;break;case 3:alert(\"Item adicionado novamente ao carrinho!\",res);return _context.abrupt(\"break\",5);case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());}function removeFromCart(){setValid(!valid);fetch(\"\".concat(process.env.REACT_APP_SERVER_URL,\"/cart/removeFromCart?id=\").concat(props.id),{method:\"get\",headers:{\"Content-Type\":\"application/json\",Accept:\"application/json\",Authorization:\"Bearer \".concat(localStorage.getItem(\"access_token\"))}}).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(res){var data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return res.json();case 2:data=_context2.sent;case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}());}return/*#__PURE__*/_jsx(CartContainer,{children:valid?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(\"img\",{src:props.image[0].original}),/*#__PURE__*/_jsxs(Info,{children:[/*#__PURE__*/_jsx(\"p\",{children:props.title}),/*#__PURE__*/_jsxs(\"sub\",{children:[\" \",props.price.toLocaleString(\"en-US\",{style:\"currency\",currency:\"USD\"}),\" \",props.portion,\"x of\",\" \",(props.price/props.portion).toLocaleString(\"en-US\",{style:\"currency\",currency:\"USD\"})]}),/*#__PURE__*/_jsx(Rating,{name:\"half-rating\",defaultValue:4.7,size:\"small\",precision:0.5,readOnly:true}),/*#__PURE__*/_jsxs(\"b\",{children:[props.deliveryPrice.toLocaleString(\"en-US\",{style:\"currency\",currency:\"USD\"}),\" \",\"to \",props.cep]})]})]}),/*#__PURE__*/_jsxs(StockInfo,{children:[/*#__PURE__*/_jsx(\"input\",{type:\"button\",value:\"Remove\",onClick:function onClick(){return removeFromCart();}}),/*#__PURE__*/_jsxs(\"strong\",{children:[\"Quantity: \",props.quantity]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Product sub total:\",\" \",props.itemSubTotal.toLocaleString(\"en-US\",{style:\"currency\",currency:\"USD\"})]}),/*#__PURE__*/_jsxs(\"sub\",{children:[props.countInStock,\" In Stock\"]})]})]}):/*#__PURE__*/_jsx(\"input\",{onClick:function onClick(){return undoRemove();},value:\"Undo\",type:\"button\"})});}function CartPage(){var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),logged=_useState4[0],setLogged=_useState4[1];var _useState5=useState({data:[]}),_useState6=_slicedToArray(_useState5,2),cartData=_useState6[0],setCartData=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),productSubTotal=_useState8[0],setSubTotal=_useState8[1];var _useState9=useState({}),_useState10=_slicedToArray(_useState9,2),userData=_useState10[0],setUserData=_useState10[1];useEffect(function(){fetch(\"\".concat(process.env.REACT_APP_SERVER_URL,\"/cart/consultTheCart\"),{method:\"get\",headers:{\"Content-Type\":\"application/json\",Accept:\"application/json\",Authorization:\"Bearer \".concat(localStorage.getItem(\"access_token\"))}}).then(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(res){var data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return res.json();case 2:data=_context3.sent;_context3.t0=res.status;_context3.next=_context3.t0===200?6:9;break;case 6:setCartData({data:data.product,data2:data.cart});setLogged(true);return _context3.abrupt(\"break\",9);case 9:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}());},[]);useEffect(function(){fetch(\"\".concat(process.env.REACT_APP_SERVER_URL,\"/auth/consult\"),{method:\"get\",headers:{\"Content-Type\":\"application/json\",Accept:\"application/json\",Authorization:\"Bearer \".concat(localStorage.getItem(\"access_token\"))}}).then(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(res){var data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return res.json();case 2:data=_context4.sent;_context4.t0=res.status;_context4.next=_context4.t0===200?6:8;break;case 6:setUserData(data);return _context4.abrupt(\"break\",8);case 8:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}());},[]);function getQuantity(id){for(var i=0;i<cartData.data2.length;i++){var cartItem=cartData.data2[i];if(id===cartItem.id){return cartItem.quantity;}}}function getSubTotal(id,price){var quantity=getQuantity(id);return quantity*price;}function getItemQuantity(){var total=0;cartData.data.forEach(function(p){var f=getQuantity(p._id);total=total+f;});return total;}useEffect(function(){var array=[];var total=0;cartData.data.forEach(function(p){var itemPrice=getSubTotal(p._id,p.price);array.push(itemPrice);});for(var i=0;i<array.length;++i){total+=array[i];}setSubTotal(total);},[cartData]);return/*#__PURE__*/_jsx(Container,{children:logged?/*#__PURE__*/_jsxs(_Fragment,{children:[cartData.data.map(function(p){return/*#__PURE__*/_jsx(CartCard,{image:p.image,title:p.name,price:p.price,portion:p.portion,rating:p.rating,deliveryPrice:p.deliveryPrice,quantity:getQuantity(p._id),itemSubTotal:getSubTotal(p._id,p.price),countInStock:p.countInStock,id:p._id,cep:userData.cep});}),/*#__PURE__*/_jsxs(FinalInfo,{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Subtotal (\",getItemQuantity(),\" items):\",\" \",/*#__PURE__*/_jsx(\"strong\",{children:productSubTotal.toLocaleString(\"en-US\",{style:\"currency\",currency:\"USD\"})})]}),/*#__PURE__*/_jsx(BuyNowBtn,{type:\"button\",value:\"Buy Now\"})]})]}):/*#__PURE__*/_jsx(\"h1\",{children:\"You must be logged to use the cart\"})});}export default CartPage;","map":{"version":3,"sources":["/home/twilightmoon/Documents/Projects/ecommerce-project/src/pages/CartPage/index.js"],"names":["React","useEffect","useState","Rating","Container","CartContainer","Info","Row","StockInfo","FinalInfo","BuyNowBtn","CartCard","props","valid","setValid","undoRemove","fetch","process","env","REACT_APP_SERVER_URL","method","headers","Authorization","localStorage","getItem","body","JSON","stringify","productId","id","quantity","then","res","status","alert","removeFromCart","Accept","json","data","image","original","title","price","toLocaleString","style","currency","portion","deliveryPrice","cep","itemSubTotal","countInStock","CartPage","logged","setLogged","cartData","setCartData","productSubTotal","setSubTotal","userData","setUserData","product","data2","cart","getQuantity","i","length","cartItem","getSubTotal","getItemQuantity","total","forEach","p","f","_id","array","itemPrice","push","map","name","rating"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport Rating from \"@material-ui/lab/Rating\";\nimport {\n  Container,\n  CartContainer,\n  Info,\n  Row,\n  StockInfo,\n  FinalInfo,\n  BuyNowBtn,\n} from \"./styles\";\n\nfunction CartCard(props) {\n  const [valid, setValid] = useState(true);\n\n  function undoRemove() {\n    setValid(!valid);\n    fetch(`${process.env.REACT_APP_SERVER_URL}/cart/addToCart`, {\n      method: \"post\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`,\n      },\n      body: JSON.stringify({\n        productId: props.id,\n        quantity: props.quantity,\n      }),\n    }).then(async (res) => {\n      switch (res.status) {\n        case 200:\n          alert(\"Item adicionado novamente ao carrinho!\", res);\n          break;\n      }\n    });\n  }\n\n  function removeFromCart() {\n    setValid(!valid);\n    fetch(\n      `${process.env.REACT_APP_SERVER_URL}/cart/removeFromCart?id=${props.id}`,\n      {\n        method: \"get\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Accept: \"application/json\",\n          Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`,\n        },\n      }\n    ).then(async (res) => {\n      let data = await res.json();\n    });\n  }\n\n  return (\n    <CartContainer>\n      {valid ? (\n        <>\n          <Row>\n            <img src={props.image[0].original}></img>\n            <Info>\n              <p>{props.title}</p>\n              <sub>\n                {\" \"}\n                {props.price.toLocaleString(\"en-US\", {\n                  style: \"currency\",\n                  currency: \"USD\",\n                })}{\" \"}\n                {props.portion}x of{\" \"}\n                {(props.price / props.portion).toLocaleString(\"en-US\", {\n                  style: \"currency\",\n                  currency: \"USD\",\n                })}\n              </sub>\n              <Rating\n                name=\"half-rating\"\n                defaultValue={4.7}\n                size=\"small\"\n                precision={0.5}\n                readOnly\n              />\n              <b>\n                {props.deliveryPrice.toLocaleString(\"en-US\", {\n                  style: \"currency\",\n                  currency: \"USD\",\n                })}{\" \"}\n                to {props.cep}\n              </b>\n            </Info>\n          </Row>\n          <StockInfo>\n            <input\n              type=\"button\"\n              value=\"Remove\"\n              onClick={() => removeFromCart()}\n            />\n            <strong>Quantity: {props.quantity}</strong>\n            <p>\n              Product sub total:{\" \"}\n              {props.itemSubTotal.toLocaleString(\"en-US\", {\n                style: \"currency\",\n                currency: \"USD\",\n              })}\n            </p>\n            <sub>{props.countInStock} In Stock</sub>\n          </StockInfo>\n        </>\n      ) : (\n        <input onClick={() => undoRemove()} value=\"Undo\" type=\"button\" />\n      )}\n    </CartContainer>\n  );\n}\n\nfunction CartPage() {\n  const [logged, setLogged] = useState(false);\n  const [cartData, setCartData] = useState({ data: [] });\n  const [productSubTotal, setSubTotal] = useState(0);\n  const [userData, setUserData] = useState({});\n\n  useEffect(() => {\n    fetch(`${process.env.REACT_APP_SERVER_URL}/cart/consultTheCart`, {\n      method: \"get\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n        Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`,\n      },\n    }).then(async (res) => {\n      let data = await res.json();\n\n      switch (res.status) {\n        case 200:\n          setCartData({ data: data.product, data2: data.cart });\n          setLogged(true);\n          break;\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    fetch(`${process.env.REACT_APP_SERVER_URL}/auth/consult`, {\n      method: \"get\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n        Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`,\n      },\n    }).then(async (res) => {\n      let data = await res.json();\n\n      switch (res.status) {\n        case 200:\n          setUserData(data);\n          break;\n      }\n    });\n  }, []);\n\n  function getQuantity(id) {\n    for (var i = 0; i < cartData.data2.length; i++) {\n      var cartItem = cartData.data2[i];\n\n      if (id === cartItem.id) {\n        return cartItem.quantity;\n      }\n    }\n  }\n\n  function getSubTotal(id, price) {\n    var quantity = getQuantity(id);\n\n    return quantity * price;\n  }\n\n  function getItemQuantity() {\n    let total = 0;\n\n    cartData.data.forEach((p) => {\n      var f = getQuantity(p._id);\n      total = total + f;\n    });\n\n    return total;\n  }\n\n  useEffect(() => {\n    var array = [];\n    var total = 0;\n\n    cartData.data.forEach((p) => {\n      var itemPrice = getSubTotal(p._id, p.price);\n\n      array.push(itemPrice);\n    });\n\n    for (var i = 0; i < array.length; ++i) {\n      total += array[i];\n    }\n\n    setSubTotal(total);\n  }, [cartData]);\n\n  return (\n    <Container>\n      {logged ? (\n        <>\n          {cartData.data.map((p) => {\n            return (\n              <CartCard\n                image={p.image}\n                title={p.name}\n                price={p.price}\n                portion={p.portion}\n                rating={p.rating}\n                deliveryPrice={p.deliveryPrice}\n                quantity={getQuantity(p._id)}\n                itemSubTotal={getSubTotal(p._id, p.price)}\n                countInStock={p.countInStock}\n                id={p._id}\n                cep={userData.cep}\n              />\n            );\n          })}\n          <FinalInfo>\n            <p>\n              Subtotal ({getItemQuantity()} items):{\" \"}\n              <strong>\n                {productSubTotal.toLocaleString(\"en-US\", {\n                  style: \"currency\",\n                  currency: \"USD\",\n                })}\n              </strong>\n            </p>\n            <BuyNowBtn type=\"button\" value=\"Buy Now\" />\n          </FinalInfo>\n        </>\n      ) : (\n        <h1>You must be logged to use the cart</h1>\n      )}\n    </Container>\n  );\n}\n\nexport default CartPage;\n"]},"metadata":{},"sourceType":"module"}