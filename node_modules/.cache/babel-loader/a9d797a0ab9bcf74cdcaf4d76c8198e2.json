{"ast":null,"code":"import _objectSpread from\"/home/twilightmoon/Documents/Projects/ecommerce-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/home/twilightmoon/Documents/Projects/ecommerce-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/home/twilightmoon/Documents/Projects/ecommerce-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/twilightmoon/Documents/Projects/ecommerce-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/twilightmoon/Documents/Projects/ecommerce-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import Dropzone from\"react-dropzone\";import{AiFillCamera}from\"../../styles/Icons\";import{uniqueId}from\"lodash\";import{WithContext as ReactTags}from\"react-tag-input\";import{Container,ProductRegisterInput,ProductRegisterSelect,ProductRegisterWrapper,Row,Column,NumberInput,InformationWrapper,FinishBtn,DropContainer,UploadMessage,ImageContainer,PriceInput,CustomHr,Preview}from\"./styles\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function FileList(_ref){var files=_ref.files;return/*#__PURE__*/_jsx(ImageContainer,{children:files.map(function(uploadedFile){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Preview,{src:uploadedFile.preview})});})});}function ProductRegister(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),desc=_useState4[0],setDesc=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),brand=_useState6[0],setBrand=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),category=_useState8[0],setCategory=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),tags=_useState10[0],setTags=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),stock=_useState12[0],setStock=_useState12[1];var _useState13=useState(0),_useState14=_slicedToArray(_useState13,2),delivery=_useState14[0],setDelPrice=_useState14[1];var _useState15=useState(0),_useState16=_slicedToArray(_useState15,2),price=_useState16[0],setPrice=_useState16[1];var _useState17=useState(0),_useState18=_slicedToArray(_useState17,2),portion=_useState18[0],setPortion=_useState18[1];var _useState19=useState([]),_useState20=_slicedToArray(_useState19,2),pictureInfo=_useState20[0],setPictureInfo=_useState20[1];function registerProduct(){var tags_array=[];var imgs_array=[];tags.map(function(i){tags_array.push(i.text);});pictureInfo.map(function(item){var img_data=new FormData();img_data.append(\"file\",item.file);fetch(\"\".concat(process.env.REACT_APP_SERVER_URL,\"/product/imageupl\"),{method:\"post\",headers:{Authorization:\"Bearer \".concat(localStorage.getItem(\"access_token\"))},body:img_data}).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(res){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return res.text();case 2:data=_context.sent;_context.t0=res.status;_context.next=_context.t0===200?6:_context.t0===400?8:10;break;case 6:imgs_array.push({original:\"\".concat(process.env.REACT_APP_SERVER_URL,\"/files/\").concat(data),thumbnail:\"\".concat(process.env.REACT_APP_SERVER_URL,\"/files/\").concat(data)});return _context.abrupt(\"break\",10);case 8:alert(\"Ocorreu um erro no processamento da imagem!\");return _context.abrupt(\"break\",10);case 10:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}());});setTimeout(function(){fetch(\"\".concat(process.env.REACT_APP_SERVER_URL,\"/product/register\"),{method:\"post\",headers:{\"Content-Type\":\"application/json\",Accept:\"application/json\",Authorization:\"Bearer \".concat(localStorage.getItem(\"access_token\"))},body:JSON.stringify({name:name,description:desc,brand:brand,category:category,tags:tags_array,countInStock:stock,deliveryPrice:delivery,price:price,portion:portion,images:imgs_array})}).then(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(res){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.t0=res.status;_context2.next=_context2.t0===404?3:_context2.t0===403?5:_context2.t0===200?7:10;break;case 3:console.log(\"Usuário não encontrado\");return _context2.abrupt(\"break\",10);case 5:console.log(\"Senha inválida\");return _context2.abrupt(\"break\",10);case 7:alert(\"Produto cadastrado!\");window.location.href=\"/\";return _context2.abrupt(\"break\",10);case 10:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref3.apply(this,arguments);};}());},3000);}function renderDragMessage(isDragActive,isDragReject){if(!isDragActive){return/*#__PURE__*/_jsx(UploadMessage,{children:\"Drag a image to here...\"});}if(isDragReject){return/*#__PURE__*/_jsx(UploadMessage,{type:\"error\",children:\"Invalid file type\"});}return/*#__PURE__*/_jsx(UploadMessage,{type:\"success\",children:\"Drop it here\"});}function handleUpload(files){files.map(function(item){setPictureInfo([].concat(_toConsumableArray(pictureInfo),[{file:item,id:uniqueId(),name:item.name,preview:URL.createObjectURL(item)}]));});}var handleDelete=function handleDelete(i){setTags(tags.filter(function(tag,index){return index!==i;}));};var handleAddition=function handleAddition(tag){setTags([].concat(_toConsumableArray(tags),[tag]));};var handleDrag=function handleDrag(tag,currPos,newPos){var newTags=tags.slice();newTags.splice(currPos,1);newTags.splice(newPos,0,tag);setTags(newTags);};var handleTagClick=function handleTagClick(index){console.log(\"The tag at index \"+index+\" was clicked\");};return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(ProductRegisterWrapper,{children:[/*#__PURE__*/_jsx(CustomHr,{}),/*#__PURE__*/_jsx(\"h1\",{children:\"Sell your item now!\"}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Column,{children:[/*#__PURE__*/_jsx(ProductRegisterInput,{type:\"textbox\",placeholder:\"Product Title*\",onChange:function onChange(e){return setName(e.target.value);}}),/*#__PURE__*/_jsx(ProductRegisterInput,{placeholder:\"Product Description*\",onChange:function onChange(e){return setDesc(e.target.value);}}),/*#__PURE__*/_jsx(ProductRegisterInput,{placeholder:\"Product Brand*\",onChange:function onChange(e){return setBrand(e.target.value);}}),/*#__PURE__*/_jsx(\"p\",{children:\"Category\"}),/*#__PURE__*/_jsxs(ProductRegisterSelect,{onChange:function onChange(e){return setCategory(e.target.value);},children:[/*#__PURE__*/_jsx(\"option\",{value:\"Cars\",children:\"Cars\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Videogames\",children:\"Videogames\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Eletrodomestics\",children:\"Eletrodomestics\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Pets\",children:\"Pets\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Music\",children:\"Music\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Sports\",children:\"Sports\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Clothing and accessories\",children:\"Clothing and accessories\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Bikes\",children:\"Bikes\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Forniture\",children:\"Forniture\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Forniture\",children:\"Books\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Forniture\",children:\"Study\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Forniture\",children:\"DIY\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Other\",children:\"Other\"})]}),/*#__PURE__*/_jsx(\"p\",{children:\"Tags\"}),/*#__PURE__*/_jsx(ReactTags,{tags:tags,handleDelete:handleDelete,handleAddition:handleAddition,handleDrag:handleDrag,handleTagClick:handleTagClick,inputFieldPosition:\"top\",autocomplete:true}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Dropzone,{accept:\"image/*\",onDropAccepted:handleUpload,children:function children(_ref4){var getRootProps=_ref4.getRootProps,getInputProps=_ref4.getInputProps,isDragActive=_ref4.isDragActive,isDragReject=_ref4.isDragReject;return/*#__PURE__*/_jsxs(DropContainer,_objectSpread(_objectSpread({},getRootProps()),{},{isDragActive:isDragActive,isDragReject:isDragReject,children:[/*#__PURE__*/_jsx(AiFillCamera,{size:30}),/*#__PURE__*/_jsx(\"input\",_objectSpread({},getInputProps())),renderDragMessage(isDragActive,isDragReject)]}));}}),!!pictureInfo.length&&/*#__PURE__*/_jsx(FileList,{files:pictureInfo})]})]}),/*#__PURE__*/_jsxs(Column,{children:[/*#__PURE__*/_jsx(NumberInput,{placeholder:\"Initial Stock*\",onChange:setStock,enableMobileNumericKeyboard:true}),/*#__PURE__*/_jsx(\"p\",{children:\"Delivery Price\"}),/*#__PURE__*/_jsx(PriceInput,{defaultValue:0,intlConfig:{locale:\"en-US\",currency:\"USD\"},onValueChange:function onValueChange(value,name){return setDelPrice(value);}}),/*#__PURE__*/_jsx(\"p\",{children:\"Price\"}),/*#__PURE__*/_jsx(PriceInput,{defaultValue:0,intlConfig:{locale:\"en-US\",currency:\"USD\"},onValueChange:function onValueChange(value,name){return setPrice(value);}}),/*#__PURE__*/_jsx(\"p\",{children:\"Portion\"}),/*#__PURE__*/_jsx(ProductRegisterSelect,{onChange:function onChange(e){return setPortion(parseInt(e.target.value));},children:[1,2,3,4,5,6,7,8,9,10,11,12].map(function(data){return/*#__PURE__*/_jsx(\"option\",{value:data,children:data});})})]})]}),/*#__PURE__*/_jsx(InformationWrapper,{children:/*#__PURE__*/_jsx(FinishBtn,{type:\"button\",value:\"Finish\",onClick:function onClick(){return alert(\"Essa função só está disponivel na branch de desenvolvimento\");}})})]})});}export default ProductRegister;","map":{"version":3,"sources":["/home/twilightmoon/Documents/Projects/ecommerce-project/src/pages/ProductRegister/index.js"],"names":["React","useEffect","useState","Dropzone","AiFillCamera","uniqueId","WithContext","ReactTags","Container","ProductRegisterInput","ProductRegisterSelect","ProductRegisterWrapper","Row","Column","NumberInput","InformationWrapper","FinishBtn","DropContainer","UploadMessage","ImageContainer","PriceInput","CustomHr","Preview","FileList","files","map","uploadedFile","preview","ProductRegister","name","setName","desc","setDesc","brand","setBrand","category","setCategory","tags","setTags","stock","setStock","delivery","setDelPrice","price","setPrice","portion","setPortion","pictureInfo","setPictureInfo","registerProduct","tags_array","imgs_array","i","push","text","item","img_data","FormData","append","file","fetch","process","env","REACT_APP_SERVER_URL","method","headers","Authorization","localStorage","getItem","body","then","res","data","status","original","thumbnail","alert","setTimeout","Accept","JSON","stringify","description","countInStock","deliveryPrice","images","console","log","window","location","href","renderDragMessage","isDragActive","isDragReject","handleUpload","id","URL","createObjectURL","handleDelete","filter","tag","index","handleAddition","handleDrag","currPos","newPos","newTags","slice","splice","handleTagClick","e","target","value","getRootProps","getInputProps","length","locale","currency","parseInt"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport Dropzone from \"react-dropzone\";\nimport { AiFillCamera } from \"../../styles/Icons\";\nimport { uniqueId } from \"lodash\";\nimport { WithContext as ReactTags } from \"react-tag-input\";\nimport {\n  Container,\n  ProductRegisterInput,\n  ProductRegisterSelect,\n  ProductRegisterWrapper,\n  Row,\n  Column,\n  NumberInput,\n  InformationWrapper,\n  FinishBtn,\n  DropContainer,\n  UploadMessage,\n  ImageContainer,\n  PriceInput,\n  CustomHr,\n  Preview,\n} from \"./styles\";\n\nfunction FileList({ files }) {\n  return (\n    <ImageContainer>\n      {files.map((uploadedFile) => (\n        <li>\n          <Preview src={uploadedFile.preview} />\n        </li>\n      ))}\n    </ImageContainer>\n  );\n}\n\nfunction ProductRegister() {\n  const [name, setName] = useState(\"\");\n  const [desc, setDesc] = useState(\"\");\n  const [brand, setBrand] = useState(\"\");\n  const [category, setCategory] = useState(\"\");\n  const [tags, setTags] = useState([]);\n  const [stock, setStock] = useState(0);\n  const [delivery, setDelPrice] = useState(0);\n  const [price, setPrice] = useState(0);\n  const [portion, setPortion] = useState(0);\n  const [pictureInfo, setPictureInfo] = useState([]);\n\n  function registerProduct() {\n    var tags_array = [];\n    var imgs_array = [];\n\n    tags.map((i) => {\n      tags_array.push(i.text);\n    });\n\n    pictureInfo.map((item) => {\n      const img_data = new FormData();\n\n      img_data.append(\"file\", item.file);\n\n      fetch(`${process.env.REACT_APP_SERVER_URL}/product/imageupl`, {\n        method: \"post\",\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`,\n        },\n        body: img_data,\n      }).then(async (res) => {\n        let data = await res.text();\n\n        switch (res.status) {\n          case 200:\n            imgs_array.push({\n              original: `${process.env.REACT_APP_SERVER_URL}/files/${data}`,\n              thumbnail: `${process.env.REACT_APP_SERVER_URL}/files/${data}`,\n            });\n            break;\n          case 400:\n            alert(\"Ocorreu um erro no processamento da imagem!\");\n          break;\n        }\n      });\n    });\n\n    setTimeout(function () {\n      fetch(`${process.env.REACT_APP_SERVER_URL}/product/register`, {\n        method: \"post\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Accept: \"application/json\",\n          Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`,\n        },\n        body: JSON.stringify({\n          name: name,\n          description: desc,\n          brand: brand,\n          category: category,\n          tags: tags_array,\n          countInStock: stock,\n          deliveryPrice: delivery,\n          price: price,\n          portion: portion,\n          images: imgs_array,\n        }),\n      }).then(async (res) => {\n        switch (res.status) {\n          case 404:\n            console.log(\"Usuário não encontrado\");\n            break;\n          case 403:\n            console.log(\"Senha inválida\");\n            break;\n          case 200:\n            alert(\"Produto cadastrado!\");\n            window.location.href = \"/\";\n            break;\n        }\n      });\n    }, 3000);\n  }\n\n  function renderDragMessage(isDragActive, isDragReject) {\n    if (!isDragActive) {\n      return <UploadMessage>Drag a image to here...</UploadMessage>;\n    }\n\n    if (isDragReject) {\n      return <UploadMessage type=\"error\">Invalid file type</UploadMessage>;\n    }\n\n    return <UploadMessage type=\"success\">Drop it here</UploadMessage>;\n  }\n\n  function handleUpload(files) {\n    files.map((item) => {\n      setPictureInfo([\n        ...pictureInfo,\n        {\n          file: item,\n          id: uniqueId(),\n          name: item.name,\n          preview: URL.createObjectURL(item),\n        },\n      ]);\n    });\n  }\n\n  const handleDelete = (i) => {\n    setTags(tags.filter((tag, index) => index !== i));\n  };\n\n  const handleAddition = (tag) => {\n    setTags([...tags, tag]);\n  };\n\n  const handleDrag = (tag, currPos, newPos) => {\n    const newTags = tags.slice();\n\n    newTags.splice(currPos, 1);\n    newTags.splice(newPos, 0, tag);\n\n    setTags(newTags);\n  };\n\n  const handleTagClick = (index) => {\n    console.log(\"The tag at index \" + index + \" was clicked\");\n  };\n\n  return (\n    <Container>\n      <ProductRegisterWrapper>\n        <CustomHr />\n        <h1>Sell your item now!</h1>\n        <Row>\n          <Column>\n            <ProductRegisterInput\n              type=\"textbox\"\n              placeholder=\"Product Title*\"\n              onChange={(e) => setName(e.target.value)}\n            />\n            <ProductRegisterInput\n              placeholder=\"Product Description*\"\n              onChange={(e) => setDesc(e.target.value)}\n            />\n            <ProductRegisterInput\n              placeholder=\"Product Brand*\"\n              onChange={(e) => setBrand(e.target.value)}\n            />\n            <p>Category</p>\n            <ProductRegisterSelect\n              onChange={(e) => setCategory(e.target.value)}\n            >\n              <option value=\"Cars\">Cars</option>\n              <option value=\"Videogames\">Videogames</option>\n              <option value=\"Eletrodomestics\">Eletrodomestics</option>\n              <option value=\"Pets\">Pets</option>\n              <option value=\"Music\">Music</option>\n              <option value=\"Sports\">Sports</option>\n              <option value=\"Clothing and accessories\">Clothing and accessories</option>\n              <option value=\"Bikes\">Bikes</option>\n              <option value=\"Forniture\">Forniture</option>\n              <option value=\"Forniture\">Books</option>\n              <option value=\"Forniture\">Study</option>\n              <option value=\"Forniture\">DIY</option>\n              <option value=\"Other\">Other</option>\n            </ProductRegisterSelect>\n            <p>Tags</p>\n            <ReactTags\n              tags={tags}\n              handleDelete={handleDelete}\n              handleAddition={handleAddition}\n              handleDrag={handleDrag}\n              handleTagClick={handleTagClick}\n              inputFieldPosition=\"top\"\n              autocomplete\n            />\n            <Row>\n              <Dropzone accept=\"image/*\" onDropAccepted={handleUpload}>\n                {({\n                  getRootProps,\n                  getInputProps,\n                  isDragActive,\n                  isDragReject,\n                }) => (\n                  <DropContainer\n                    {...getRootProps()}\n                    isDragActive={isDragActive}\n                    isDragReject={isDragReject}\n                  >\n                    <AiFillCamera size={30} />\n                    <input {...getInputProps()} />\n                    {renderDragMessage(isDragActive, isDragReject)}\n                  </DropContainer>\n                )}\n              </Dropzone>\n              {!!pictureInfo.length && (\n                <FileList files={pictureInfo}></FileList>\n              )}\n            </Row>\n          </Column>\n          <Column>\n            <NumberInput\n              placeholder=\"Initial Stock*\"\n              onChange={setStock}\n              enableMobileNumericKeyboard\n            />\n            <p>Delivery Price</p>\n            <PriceInput\n              defaultValue={0}\n              intlConfig={{ locale: \"en-US\", currency: \"USD\" }}\n              onValueChange={(value, name) => setDelPrice(value)}\n            />\n            <p>Price</p>\n            <PriceInput\n              defaultValue={0}\n              intlConfig={{ locale: \"en-US\", currency: \"USD\" }}\n              onValueChange={(value, name) => setPrice(value)}\n            />\n            <p>Portion</p>\n            <ProductRegisterSelect\n              onChange={(e) => setPortion(parseInt(e.target.value))}\n            >\n              {[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12].map((data) => (\n                <option value={data}>{data}</option>\n              ))}\n            </ProductRegisterSelect>\n          </Column>\n        </Row>\n        <InformationWrapper>\n           <FinishBtn\n            type=\"button\"\n            value=\"Finish\"\n            onClick={() => alert(\"Essa função só está disponivel na branch de desenvolvimento\")}\n          /> \n        </InformationWrapper>\n      </ProductRegisterWrapper>\n    </Container>\n  );\n}\n\nexport default ProductRegister;\n"]},"metadata":{},"sourceType":"module"}