{"ast":null,"code":"var _jsxFileName = \"/home/twilightmoon/Documents/Projects/ecommerce-project/client/src/pages/CartPage/index.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport Rating from \"@material-ui/lab/Rating\";\nimport { Container, CartContainer, Info, Row, StockInfo, FinalInfo, BuyNowBtn } from \"./styles\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction CartCard(props) {\n  _s();\n\n  const [valid, setValid] = useState(true);\n\n  function undoRemove() {\n    setValid(!valid);\n    fetch(`${process.env.REACT_APP_SERVER_URL}/cart/addToCart`, {\n      method: \"post\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`\n      },\n      body: JSON.stringify({\n        productId: props.id,\n        quantity: props.quantity\n      })\n    }).then(async res => {\n      switch (res.status) {\n        case 200:\n          alert(\"Item adicionado novamente ao carrinho!\", res);\n          break;\n      }\n    });\n  }\n\n  function removeFromCart() {\n    setValid(!valid);\n    fetch(`${process.env.REACT_APP_SERVER_URL}/cart/removeFromCart?id=${props.id}`, {\n      method: \"get\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n        Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`\n      }\n    }).then(async res => {\n      let data = await res.json();\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(CartContainer, {\n    children: valid ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Row, {\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: props.image[0].original\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Info, {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: props.title\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 61,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"sub\", {\n            children: [\" \", props.price.toLocaleString(\"en-US\", {\n              style: \"currency\",\n              currency: \"USD\"\n            }), \" \", props.portion, \"x of\", \" \", (props.price / props.portion).toLocaleString(\"en-US\", {\n              style: \"currency\",\n              currency: \"USD\"\n            })]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 62,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Rating, {\n            name: \"half-rating\",\n            defaultValue: 4.7,\n            size: \"small\",\n            precision: 0.5,\n            readOnly: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 74,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"b\", {\n            children: [props.deliveryPrice.toLocaleString(\"en-US\", {\n              style: \"currency\",\n              currency: \"USD\"\n            }), \" \", \"to \", props.cep]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(StockInfo, {\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"button\",\n          value: \"Remove\",\n          onClick: () => removeFromCart()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n          children: [\"Quantity: \", props.quantity]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Product sub total:\", \" \", props.itemSubTotal.toLocaleString(\"en-US\", {\n            style: \"currency\",\n            currency: \"USD\"\n          })]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"sub\", {\n          children: [props.countInStock, \" In Stock\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true) : /*#__PURE__*/_jsxDEV(\"input\", {\n      onClick: () => undoRemove(),\n      value: \"Undo\",\n      type: \"button\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 5\n  }, this);\n}\n\n_s(CartCard, \"y17It3gqk1OMGr51fZAuRFWogoE=\");\n\n_c = CartCard;\n\nfunction CartPage() {\n  _s2();\n\n  const [logged, setLogged] = useState(false);\n  const [cartData, setCartData] = useState({\n    data: []\n  });\n  const [productSubTotal, setSubTotal] = useState(0);\n  const [userData, setUserData] = useState({});\n  useEffect(() => {\n    fetch(`${process.env.REACT_APP_SERVER_URL}/cart/consultTheCart`, {\n      method: \"get\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n        Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`\n      }\n    }).then(async res => {\n      let data = await res.json();\n\n      switch (res.status) {\n        case 200:\n          setCartData({\n            data: data.product,\n            data2: data.cart\n          });\n          setLogged(true);\n          break;\n      }\n    });\n  }, []);\n  useEffect(() => {\n    fetch(`${process.env.REACT_APP_SERVER_URL}/auth/consult`, {\n      method: \"get\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n        Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`\n      }\n    }).then(async res => {\n      let data = await res.json();\n\n      switch (res.status) {\n        case 200:\n          setUserData(data);\n          break;\n      }\n    });\n  }, []);\n\n  function getQuantity(id) {\n    for (var i = 0; i < cartData.data2.length; i++) {\n      var cartItem = cartData.data2[i];\n\n      if (id === cartItem.id) {\n        return cartItem.quantity;\n      }\n    }\n  }\n\n  function getSubTotal(id, price) {\n    var quantity = getQuantity(id);\n    return quantity * price;\n  }\n\n  function getItemQuantity() {\n    let total = 0;\n    cartData.data.forEach(p => {\n      var f = getQuantity(p._id);\n      total = total + f;\n    });\n    return total;\n  }\n\n  useEffect(() => {\n    var array = [];\n    var total = 0;\n    cartData.data.forEach(p => {\n      var itemPrice = getSubTotal(p._id, p.price);\n      array.push(itemPrice);\n    });\n\n    for (var i = 0; i < array.length; ++i) {\n      total += array[i];\n    }\n\n    setSubTotal(total);\n  }, [cartData]);\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: logged ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [cartData.data.map(p => {\n        return /*#__PURE__*/_jsxDEV(CartCard, {\n          image: p.image,\n          title: p.name,\n          price: p.price,\n          portion: p.portion,\n          rating: p.rating,\n          deliveryPrice: p.deliveryPrice,\n          quantity: getQuantity(p._id),\n          itemSubTotal: getSubTotal(p._id, p.price),\n          countInStock: p.countInStock,\n          id: p._id,\n          cep: userData.cep\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 15\n        }, this);\n      }), /*#__PURE__*/_jsxDEV(FinalInfo, {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Subtotal (\", getItemQuantity(), \" items):\", \" \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: productSubTotal.toLocaleString(\"en-US\", {\n              style: \"currency\",\n              currency: \"USD\"\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(BuyNowBtn, {\n          type: \"button\",\n          value: \"Buy Now\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true) : /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"You must be logged to use the cart\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 204,\n    columnNumber: 5\n  }, this);\n}\n\n_s2(CartPage, \"rROfm32XdV5F7Yqdk9P378VjQco=\");\n\n_c2 = CartPage;\nexport default CartPage;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"CartCard\");\n$RefreshReg$(_c2, \"CartPage\");","map":{"version":3,"sources":["/home/twilightmoon/Documents/Projects/ecommerce-project/client/src/pages/CartPage/index.js"],"names":["React","useEffect","useState","Rating","Container","CartContainer","Info","Row","StockInfo","FinalInfo","BuyNowBtn","CartCard","props","valid","setValid","undoRemove","fetch","process","env","REACT_APP_SERVER_URL","method","headers","Authorization","localStorage","getItem","body","JSON","stringify","productId","id","quantity","then","res","status","alert","removeFromCart","Accept","data","json","image","original","title","price","toLocaleString","style","currency","portion","deliveryPrice","cep","itemSubTotal","countInStock","CartPage","logged","setLogged","cartData","setCartData","productSubTotal","setSubTotal","userData","setUserData","product","data2","cart","getQuantity","i","length","cartItem","getSubTotal","getItemQuantity","total","forEach","p","f","_id","array","itemPrice","push","map","name","rating"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport Rating from \"@material-ui/lab/Rating\";\nimport {\n  Container,\n  CartContainer,\n  Info,\n  Row,\n  StockInfo,\n  FinalInfo,\n  BuyNowBtn,\n} from \"./styles\";\n\nfunction CartCard(props) {\n  const [valid, setValid] = useState(true);\n\n  function undoRemove() {\n    setValid(!valid);\n    fetch(`${process.env.REACT_APP_SERVER_URL}/cart/addToCart`, {\n      method: \"post\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`,\n      },\n      body: JSON.stringify({\n        productId: props.id,\n        quantity: props.quantity,\n      }),\n    }).then(async (res) => {\n      switch (res.status) {\n        case 200:\n          alert(\"Item adicionado novamente ao carrinho!\", res);\n          break;\n      }\n    });\n  }\n\n  function removeFromCart() {\n    setValid(!valid);\n    fetch(\n      `${process.env.REACT_APP_SERVER_URL}/cart/removeFromCart?id=${props.id}`,\n      {\n        method: \"get\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Accept: \"application/json\",\n          Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`,\n        },\n      }\n    ).then(async (res) => {\n      let data = await res.json();\n    });\n  }\n\n  return (\n    <CartContainer>\n      {valid ? (\n        <>\n          <Row>\n            <img src={props.image[0].original}></img>\n            <Info>\n              <p>{props.title}</p>\n              <sub>\n                {\" \"}\n                {props.price.toLocaleString(\"en-US\", {\n                  style: \"currency\",\n                  currency: \"USD\",\n                })}{\" \"}\n                {props.portion}x of{\" \"}\n                {(props.price / props.portion).toLocaleString(\"en-US\", {\n                  style: \"currency\",\n                  currency: \"USD\",\n                })}\n              </sub>\n              <Rating\n                name=\"half-rating\"\n                defaultValue={4.7}\n                size=\"small\"\n                precision={0.5}\n                readOnly\n              />\n              <b>\n                {props.deliveryPrice.toLocaleString(\"en-US\", {\n                  style: \"currency\",\n                  currency: \"USD\",\n                })}{\" \"}\n                to {props.cep}\n              </b>\n            </Info>\n          </Row>\n          <StockInfo>\n            <input\n              type=\"button\"\n              value=\"Remove\"\n              onClick={() => removeFromCart()}\n            />\n            <strong>Quantity: {props.quantity}</strong>\n            <p>\n              Product sub total:{\" \"}\n              {props.itemSubTotal.toLocaleString(\"en-US\", {\n                style: \"currency\",\n                currency: \"USD\",\n              })}\n            </p>\n            <sub>{props.countInStock} In Stock</sub>\n          </StockInfo>\n        </>\n      ) : (\n        <input onClick={() => undoRemove()} value=\"Undo\" type=\"button\" />\n      )}\n    </CartContainer>\n  );\n}\n\nfunction CartPage() {\n  const [logged, setLogged] = useState(false);\n  const [cartData, setCartData] = useState({ data: [] });\n  const [productSubTotal, setSubTotal] = useState(0);\n  const [userData, setUserData] = useState({});\n\n  useEffect(() => {\n    fetch(`${process.env.REACT_APP_SERVER_URL}/cart/consultTheCart`, {\n      method: \"get\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n        Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`,\n      },\n    }).then(async (res) => {\n      let data = await res.json();\n\n      switch (res.status) {\n        case 200:\n          setCartData({ data: data.product, data2: data.cart });\n          setLogged(true);\n          break;\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    fetch(`${process.env.REACT_APP_SERVER_URL}/auth/consult`, {\n      method: \"get\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n        Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`,\n      },\n    }).then(async (res) => {\n      let data = await res.json();\n\n      switch (res.status) {\n        case 200:\n          setUserData(data);\n          break;\n      }\n    });\n  }, []);\n\n  function getQuantity(id) {\n    for (var i = 0; i < cartData.data2.length; i++) {\n      var cartItem = cartData.data2[i];\n\n      if (id === cartItem.id) {\n        return cartItem.quantity;\n      }\n    }\n  }\n\n  function getSubTotal(id, price) {\n    var quantity = getQuantity(id);\n\n    return quantity * price;\n  }\n\n  function getItemQuantity() {\n    let total = 0;\n\n    cartData.data.forEach((p) => {\n      var f = getQuantity(p._id);\n      total = total + f;\n    });\n\n    return total;\n  }\n\n  useEffect(() => {\n    var array = [];\n    var total = 0;\n\n    cartData.data.forEach((p) => {\n      var itemPrice = getSubTotal(p._id, p.price);\n\n      array.push(itemPrice);\n    });\n\n    for (var i = 0; i < array.length; ++i) {\n      total += array[i];\n    }\n\n    setSubTotal(total);\n  }, [cartData]);\n\n  return (\n    <Container>\n      {logged ? (\n        <>\n          {cartData.data.map((p) => {\n            return (\n              <CartCard\n                image={p.image}\n                title={p.name}\n                price={p.price}\n                portion={p.portion}\n                rating={p.rating}\n                deliveryPrice={p.deliveryPrice}\n                quantity={getQuantity(p._id)}\n                itemSubTotal={getSubTotal(p._id, p.price)}\n                countInStock={p.countInStock}\n                id={p._id}\n                cep={userData.cep}\n              />\n            );\n          })}\n          <FinalInfo>\n            <p>\n              Subtotal ({getItemQuantity()} items):{\" \"}\n              <strong>\n                {productSubTotal.toLocaleString(\"en-US\", {\n                  style: \"currency\",\n                  currency: \"USD\",\n                })}\n              </strong>\n            </p>\n            <BuyNowBtn type=\"button\" value=\"Buy Now\" />\n          </FinalInfo>\n        </>\n      ) : (\n        <h1>You must be logged to use the cart</h1>\n      )}\n    </Container>\n  );\n}\n\nexport default CartPage;\n"]},"metadata":{},"sourceType":"module"}